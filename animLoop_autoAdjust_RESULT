// minimum value of loop
var minVal = effect("Minimum Value")("Slider").value;
// maximum value of loop
var maxVal = effect("Maximum Value")("Slider").value;
// whether animation begins at maximum or minimum value
var ascending = effect("Animate Min to Max")("Checkbox").value;

// main function
if (time >= inPoint) {
  // where to start animation (defaults to in point of layer, as time)
  var animStart = inPoint;
  // loop duration, as time
  var loopDur = framesToTime(effect("Loop Duration")("Slider")) / 2;
  // duration of hold, as time
  var holdDur = framesToTime(effect("Hold Duration")("Slider").value);
  // duration of fade, as time
  var fadeDur = loopDur - holdDur;
  // whether hold happens before or after animation
  var holdFirst = effect("Hold Precedes Animation")("Checkbox").value;

  while (time > (animStart + loopDur)) {
    animStart += loopDur;
    ascending = !ascending;
  }

  if (holdFirst === True) {
    holdDur *= -1;
  }

  linear(time - animStart + holdDur, loopDur - fadeDur, loopDur, ascending ? minVal : maxVal, ascending ? maxVal : minVal);
} else if (ascending === True) {
  minVal;
} else {
  maxVal;
}
